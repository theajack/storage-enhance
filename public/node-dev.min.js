!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.StorageEnhance=e():t.StorageEnhance=e()}(this,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e,r){"use strict";r.d(e,"f",(function(){return n})),r.d(e,"d",(function(){return o})),r.d(e,"e",(function(){return a})),r.d(e,"b",(function(){return i})),r.d(e,"g",(function(){return u})),r.d(e,"a",(function(){return c})),r.d(e,"c",(function(){return f}));var n="object"==typeof window&&!!window&&!a(window.localStorage),o="object"==typeof wx&&!!wx;function a(t){return void 0===t}function i(t){if(null===t||"object"!=typeof t)return t;var e=Array.isArray(t)?[]:{};for(var r in t)t.hasOwnProperty(r)&&(e[r]=i(t[r]));return e}function u(t){try{return JSON.parse(t)}catch(t){return null}}function c(t){var e=t.key,r=t.path;return r&&"/"!==r||(r=""),r+"/"+encodeURIComponent(e)}function f(t){return t.map((function(t){return function(t){return t.substring(t.lastIndexOf("/")+1)}(t)}))}},function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(0),o=n.f?"web":n.d?"miniapp":"node"},function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return p}));var n=r(1),o=r(3),a={},i={};"node"===n.a&&(a=r(5),i=r(6));var u="/storage-enhance-node",c=t.env.HOME||t.env.USERPROFILE||"/";if("node"===n.a){var f=i.resolve(c,"."+u);a.existsSync(f)||a.mkdirSync(f)}var p={length:function(t){var e=(void 0===t?{}:t).path;return this.keys({path:e}).length},keys:function(t){return y("",h({key:"",path:(void 0===t?{}:t).path}),[])},exist:function(t){var e=h({key:t.key,path:t.path});return a.existsSync(e)},get:function(t){return l({key:t.key,path:t.path})},set:function(t){var e=t.key,r=t.value,n=h({key:e,path:t.path});return console.log(n),a.writeFileSync(n,r),!0},remove:function(t){var e=h({key:t.key,path:t.path});if(a.existsSync(e))try{return a.rmSync(v(e)),!0}catch(t){return!1}return!1},all:function(t){var e=(void 0===t?{}:t).path;return this.keys({path:e}).map((function(t){return l({key:t,check:!1,filePath:s(t,e)})}))},clear:function(t){var e=h({key:"",path:(void 0===t?{}:t).path});if(a.existsSync(e))try{return console.log(e),function t(e){for(var r=a.readdirSync(e),n=0,o=r.length;n<o;n++){var i=r[n],u=i.lastIndexOf(".json"),c=e+"/"+i;-1!==u?a.rmSync(v(c)):(t(c),a.rmdirSync(v(c)))}}(e),!0}catch(t){return console.log(t),!1}return console.log(e),!1}};function s(t,e){return void 0===e&&(e=""),i.resolve(c,"."+u+e+t+".json")}function l(t){var e=t.key,r=t.path,n=t.check,i=void 0===n||n,u=t.filePath;return u=u||h({key:e,path:r}),!i||a.existsSync(u)?a.readFileSync(u,"utf-8"):o.a}function y(t,e,r){for(var n=a.readdirSync(e),o=0,u=n.length;o<u;o++){var c=n[o],f=c.lastIndexOf(".json");-1!==f?r.push(t+"/"+c.substring(0,f)):y(t+"/"+c,i.resolve(e,c),r)}return r}function h(t){var e=t.key,r=t.path,n=void 0===r?"":r;if(n)for(var o=n.split("/"),f="",p=0;p<o.length;p++)if(o[p]){f+="/"+o[p];var s=i.resolve(c,"."+u+f);a.existsSync(s)||a.mkdirSync(s)}return e&&(e="/"+e+".json"),i.resolve(c,"."+u+n+e)}function v(t){if(-1===t.indexOf(u))throw new Error("Invaild Removed FilePath:"+t);return t}}).call(this,r(4))},function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=Symbol("storage-empty")},function(t,e){var r,n,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(t){r=a}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(t){n=i}}();var c,f=[],p=!1,s=-1;function l(){p&&c&&(p=!1,c.length?f=c.concat(f):s=-1,f.length&&y())}function y(){if(!p){var t=u(l);p=!0;for(var e=f.length;e;){for(c=f,f=[];++s<e;)c&&c[s].run();s=-1,e=f.length}c=null,p=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];f.push(new h(t,e)),1!==f.length||p||u(y)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("path")},function(t,e,r){"use strict";r.r(e);var n=r(0),o={length:function(t){var e=(void 0===t?{}:t).path;return this.keys({path:e}).length},keys:function(t){var e=(void 0===t?{}:t).path,r=wx.getStorageInfoSync().keys;return e?Object(n.c)(r.filter((function(t){return 0===t.indexOf(e)}))):Object(n.c)(r)},get:function(t){var e=t.key,r=t.path;return e=Object(n.a)({key:e,path:r}),wx.getStorageSync(e)},set:function(t){var e=t.key,r=t.value,o=t.path;try{return e=Object(n.a)({key:e,path:o}),wx.setStorageSync(e,r),!0}catch(t){return!1}},remove:function(t){var e=t.key,r=t.path;try{return e=Object(n.a)({key:e,path:r}),wx.removeStorageSync(e),!0}catch(t){return!1}},clear:function(t){var e=(void 0===t?{}:t).path;try{if(e)for(var r=this.keys({path:e}),n=0,o=r.length;n<o;n++)this.remove({key:r[n]});else wx.clearStorageSync();return!0}catch(t){return!1}},all:function(t){for(var e=(void 0===t?{}:t).path,r={},n=this.keys({path:e}),o=0,a=n.length;o<a;o++){var i=n[o];r[i]=this.get({key:i})}return r},exist:function(t){var e=t.key,r=t.path;return-1!==this.keys({path:r}).indexOf(e)}},a=r(1),i="local";function u(){return i}var c={date:Date,reg:RegExp};function f(t){var e=typeof t;if("object"===e){var r=function(t){if(!t)return"null";for(var e in c){var r=e,o=c[r];if(!Object(n.e)(o)&&t instanceof o)return r}return""}(t);if(r)return r}return e}"web"===a.a&&(c.html=HTMLElement);var p={length:function(t){var e=void 0===t?{}:t,r=e.type,n=e.path,o=s(r);return n?Object.keys(o).filter((function(t){return 0===t.indexOf(n)})).length:o.length},keys:function(t){var e=void 0===t?{}:t,r=e.type,o=e.path,a=Object.keys(s(r));return o?Object(n.c)(a.filter((function(t){return 0===t.indexOf(o)}))):Object(n.c)(a)},get:function(t){var e=t.key,r=t.type,o=t.path;return e=Object(n.a)({key:e,path:o}),s(r).getItem(e)},set:function(t){var e=t.key,r=t.value,o=t.type,a=t.path;try{return e=Object(n.a)({key:e,path:a}),s(o).setItem(e,r),!0}catch(t){return!1}},remove:function(t){var e=t.key,r=t.type,o=t.path;try{return e=Object(n.a)({key:e,path:o}),s(r).removeItem(e),!0}catch(t){return!1}},clear:function(t){var e=void 0===t?{}:t,r=e.type,n=e.path;try{if(n)for(var o=this.keys({path:n,type:r}),a=0,i=o.length;a<i;a++)this.remove({key:o[a],type:r});else s(r).clear();return!0}catch(t){return!1}},all:function(t){for(var e=void 0===t?{}:t,r=e.type,n=e.path,o={},a=s(r),i=this.keys({type:r,path:n}),u=0,c=i.length;u<c;u++){var f=i[u];o[f]=a.getItem(f)}return o},exist:function(t){var e=t.key,r=t.type,o=t.path;return e=Object(n.a)({key:e,path:o}),s(r).hasOwnProperty(e)}};function s(t){return void 0===t&&(t=u()),"local"===t?window.localStorage:window.sessionStorage}var l=r(2),y={function:{set:function(t){return"return "+t.toString()+";"},get:function(t){return new Function(t)()}},reg:{set:function(t){return t.toString()},get:function(t){return new RegExp(t)}},html:{set:function(t){return t.outerHTML},get:function(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]}},date:{set:function(t){return t.getTime()},get:function(t){return new Date(t)}}};function h(t){var e=t.type,r=t.data,n=t.oprate,o=y[e];return o?o[n](r):r}function v(t){var e=t.data,r=t.storageType;return"temp"===(void 0===r?"local":r)?e.value:h({type:e.type,data:e.value,oprate:"get"})}var d={};function g(t,e){if(void 0===t&&(t=""),void 0===e&&(e="get"),!t||"/"===t){if("get"===e||"set"===e)return d;if("clear"===e)return d={},!0}for(var r=t.split("/"),n=d,o=0,a=r.length;o<a;o++){var i=r[o];if(i){if(!n[i])if("set"===e)n[i]={};else{if("get"===e)return n;if("clear"===e)return!1}if("clear"===e&&o===a-1)return delete n[i],!0;n=n[i]}}return n}var k={length:function(t){var e=(void 0===t?{}:t).path;return this.keys({path:e}).length},keys:function(t){var e=(void 0===t?{}:t).path;return Object.keys(g(e))},exist:function(t){var e=t.key;return g(t.path).hasOwnProperty(e)},get:function(t){var e=t.key,r=t.path;return this.exist({key:e})?Object(n.b)(g(r)[e]):null},set:function(t){var e=t.key,r=t.value;return g(t.path,"set")[e]=Object(n.b)(r),!0},remove:function(t){var e=t.key;return delete g(t.path)[e],!0},all:function(t){var e=(void 0===t?{}:t).path;return Object(n.b)(g(e))},clear:function(t){return g((void 0===t?{}:t).path,"clear")}},m=r(3),b={web:p,miniapp:o,node:l.a}[a.a];function w(t){return void 0===t&&(t=u()),"temp"===t||"web"!==a.a&&"local"!==t?k:b}var x={env:a.a,type:function(t){if(!t)return u();!function(t){i=t}(t)},length:function(t){var e=void 0===t?{}:t,r=e.type,n=e.path;return w(r).length({type:r,path:n})},clear:function(t){var e=void 0===t?{}:t,r=e.type,n=e.path;return w(r).clear({type:r,path:n})},keys:function(t){var e=void 0===t?{}:t,r=e.type,n=e.path;return w(r).keys({type:r,path:n})},remove:function(t){var e=t.key,r=t.type,n=t.path;return""===e||w(r).remove({key:e,type:r,path:n})},exist:function(t){var e=t.key,r=t.type,n=t.path;return""!==e&&w(r).exist({key:e,type:r,path:n})},get:function(t){var e=t.key,r=t.type,o=t.path;if(""===e)return m.a;var i=w(r).get({key:e,type:r,path:o});if("temp"===r||"miniapp"===a.a)return v({storageType:r,data:i});var u=Object(n.g)(i);return u?v({storageType:r,data:u}):i},set:function(t){var e=t.key,r=t.value,n=t.path,o=t.type,i=void 0===o?"local":o;if(""===e)return!1;var u=function(t){var e=t.data,r=t.storageType,n=void 0===r?"local":r,o=f(e);return{type:o,value:"temp"===n?e:h({type:o,data:e,oprate:"set"})}}({data:r,storageType:i}),c=w(i);return"temp"===i||"miniapp"===a.a?c.set({key:e,value:u,path:n,type:i}):c.set({key:e,value:JSON.stringify(u),path:n,type:i})},all:function(t){for(var e=void 0===t?{}:t,r=e.type,n=e.path,o=this.keys({type:r,path:n}),a={},i=0,u=o.length;i<u;i++){var c=o[i];a[c]=this.get({key:c,type:r,path:n})}return a}};e.default=x}]).default}));