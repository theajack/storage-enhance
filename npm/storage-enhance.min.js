!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.StorageEnhance=e():t.StorageEnhance=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),o=r.d?"web":r.b?"miniapp":"node"},function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i})),n.d(e,"e",(function(){return a}));var r="object"==typeof window&&!!window&&!u(window.localStorage),o="object"==typeof wx&&!!wx;function u(t){return void 0===t}function i(t){if(null===t||"object"!=typeof t)return t;var e=Array.isArray(t)?[]:{};for(var n in t)t.hasOwnProperty(n)&&(e[n]=i(t[n]));return e}function a(t){try{return JSON.parse(t)}catch(t){return null}}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return y}));var r=n(0),o=n(3),u={},i={};"node"===r.a&&(u=n(5),i=n(6));var a="/storage-enhance-node",c="node"===r.a&&(t.env.HOME||t.env.USERPROFILE)||"",f="node"===r.a?i.resolve(c,"."+a):"";"node"===r.a&&(u.existsSync(f)||u.mkdirSync(f));var y={length:function(t){var e=(void 0===t?{}:t).path;return this.keys({path:e}).length},keys:function(t){return p("",v({key:"",path:(void 0===t?{}:t).path}),[])},exist:function(t){var e=v({key:t.key,path:t.path});return u.existsSync(e)},get:function(t){return l({key:t.key,path:t.path})},set:function(t){var e=t.key,n=t.value,r=v({key:e,path:t.path});return u.writeFileSync(r,JSON.stringify(n)),!0},remove:function(t){var e=v({key:t.key,path:t.path});if(u.existsSync(e))try{return u.rmSync(e),!0}catch(t){return!1}return!1},all:function(t){var e=(void 0===t?{}:t).path;return this.keys({path:e}).map((function(t){return l({key:t,check:!1,filePath:s(t,e)})}))},clear:function(t){var e=v({key:"",path:(void 0===t?{}:t).path});if(u.existsSync(e))try{return u.rmdirSync(e),!0}catch(t){return!1}return!1}};function s(t,e){return void 0===e&&(e=""),i.resolve(c,"."+a+e+t+".json")}function l(t){var e=t.key,n=t.path,r=t.check,i=void 0===r||r,a=t.filePath;return a=a||v({key:e,path:n}),!i||u.existsSync(a)?u.readFileSync(a,"utf-8"):o.a}function p(t,e,n){for(var r=u.readdirSync(e),o=0,a=r.length;o<a;o++){var c=r[o],f=c.lastIndexOf(".json");-1!==f?n.push(t+"/"+c.substring(0,f)):p(t+"/"+c,i.resolve(e,c),n)}return n}function v(t){var e=t.key,n=t.path,r=void 0===n?"":n;if(r)for(var o=r.split("/"),f="",y=0;y<o.length;y++)if(o[y]){f+="/"+o[y];var s=i.resolve(c,"."+a+f);u.existsSync(s)||u.mkdirSync(s)}return i.resolve(c,"."+a+r+"/"+encodeURIComponent(e)+".json")}}).call(this,n(4))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=Symbol("storage-empty")},function(t,e){var n,r,o=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===u||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:u}catch(t){n=u}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var c,f=[],y=!1,s=-1;function l(){y&&c&&(y=!1,c.length?f=c.concat(f):s=-1,f.length&&p())}function p(){if(!y){var t=a(l);y=!0;for(var e=f.length;e;){for(c=f,f=[];++s<e;)c&&c[s].run();s=-1,e=f.length}c=null,y=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function v(t,e){this.fun=t,this.array=e}function h(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new v(t,e)),1!==f.length||y||a(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("path")},function(t,e,n){"use strict";n.r(e);var r={length:function(){return this.keys().length},keys:function(){return wx.getStorageInfoSync().keys},get:function(t){var e=t.key;return wx.getStorageSync(e)},set:function(t){var e=t.key,n=t.value;try{return wx.setStorageSync(e,n),!0}catch(t){return!1}},remove:function(t){var e=t.key;try{return wx.removeStorageSync(e),!0}catch(t){return!1}},clear:function(){try{return wx.clearStorageSync(),!0}catch(t){return!1}},all:function(){for(var t={},e=this.keys(),n=0,r=e.length;n<r;n++){var o=e[n];t[o]=this.get({key:o})}return t},exist:function(t){var e=t.key;return-1!==this.keys().indexOf(e)}},o=n(1),u=n(0),i="local";function a(){return i}var c={date:Date,reg:RegExp};function f(t){var e=typeof t;if("object"===e){var n=function(t){if(!t)return"null";for(var e in c){var n=e,r=c[n];if(!Object(o.c)(r)&&t instanceof r)return n}return""}(t);if(n)return n}return e}function y(t){return t.map((function(t){return function(t){return t.substring(t.lastIndexOf("/")+1)}(t)}))}"web"===u.a&&(c.html=HTMLElement);var s={length:function(t){var e=void 0===t?{}:t,n=e.type,r=e.path,o=void 0===r?"":r,u=l(n);return o?Object.keys(u).filter((function(t){return 0===t.indexOf(o)})).length:u.length},keys:function(t){var e=void 0===t?{}:t,n=e.type,r=e.path,o=Object.keys(l(n));return y(r?o.filter((function(t){return 0===t.indexOf(r)})):o)},get:function(t){var e=t.key,n=t.type;return e=p({key:e,path:t.path}),l(n).getItem(e)},set:function(t){var e=t.key,n=t.value,r=t.type,o=t.path;try{return e=p({key:e,path:o}),l(r).setItem(e,n),!0}catch(t){return!1}},remove:function(t){var e=t.key,n=t.type,r=t.path;try{return e=p({key:e,path:r}),l(n).removeItem(e),!0}catch(t){return!1}},clear:function(t){var e=void 0===t?{}:t,n=e.type,r=e.path;try{if(r)for(var o=this.keys({path:r,type:n}),u=0,i=o.length;u<i;u++)this.remove({key:o[u],type:n});else l(n).clear();return!0}catch(t){return!1}},all:function(t){for(var e=void 0===t?{}:t,n=e.type,r=e.path,o={},u=l(n),i=this.keys({type:n,path:r}),a=0,c=i.length;a<c;a++){var f=i[a];o[f]=u.getItem(f)}return o},exist:function(t){var e=t.key,n=t.type;return e=p({key:e,path:t.path}),l(n).hasOwnProperty(e)}};function l(t){return void 0===t&&(t=a()),"local"===t?window.localStorage:window.sessionStorage}function p(t){var e=t.key;return t.path+"/"+encodeURIComponent(e)}var v=n(2),h={function:{set:function(t){return"return "+t.toString()+";"},get:function(t){return new Function(t)()}},reg:{set:function(t){return t.toString()},get:function(t){return new RegExp(t)}},html:{set:function(t){return t.outerHTML},get:function(t){var e=document.createElement("div");return e.innerHTML=t,e.children[0]}},date:{set:function(t){return t.getTime()},get:function(t){return new Date(t)}}};function d(t){var e=t.type,n=t.data,r=t.oprate,o=h[e];return o?o[r](n):n}function g(t){var e=t.data,n=t.storageType;return"temp"===(void 0===n?"local":n)?e.value:d({type:e.type,data:e.value,oprate:"get"})}var k={},m={length:function(){return this.keys().length},keys:function(){return Object.keys(k)},exist:function(t){var e=t.key;return k.hasOwnProperty(e)},get:function(t){var e=t.key;return this.exist({key:e})?Object(o.a)(k[e]):null},set:function(t){var e=t.key,n=t.value;return k[e]=Object(o.a)(n),!0},remove:function(t){var e=t.key;return delete k[e],!0},all:function(){return Object(o.a)(k)},clear:function(){return k={},!0}},b={web:s,miniapp:r,node:v.a}[u.a];function w(t){return void 0===t&&(t=a()),"temp"===t||"web"!==u.a&&"local"!==t?m:b}var x={env:u.a,type:function(t){if(!t)return a();!function(t){i=t}(t)},length:function(t){var e=(void 0===t?{}:t).type;return w(e).length({type:e})},clear:function(t){var e=(void 0===t?{}:t).type;return w(e).clear({type:e})},keys:function(t){var e=(void 0===t?{}:t).type;return w(e).keys({type:e})},remove:function(t){var e=t.key,n=t.type;return w(n).remove({key:e,type:n})},exist:function(t){var e=t.key,n=t.type;return w(n).exist({key:e,type:n})},get:function(t){var e=t.key,n=t.type,r=w(n).get({key:e,type:n});if("temp"===n||"miniapp"===u.a)return g({storageType:n,data:r});var i=Object(o.e)(r);return i?g({storageType:n,data:i}):r},set:function(t){var e=t.key,n=t.value,r=t.type,o=void 0===r?"local":r,i=function(t){var e=t.data,n=t.storageType,r=void 0===n?"local":n,o=f(e);return{type:o,value:"temp"===r?e:d({type:o,data:e,oprate:"set"})}}({data:n,storageType:o}),a=w(o);return"temp"===o||"miniapp"===u.a?a.set({key:e,value:i,type:o}):a.set({key:e,value:JSON.stringify(i),type:o})},all:function(t){for(var e=(void 0===t?{}:t).type,n=this.keys({type:e}),r={},o=0,u=n.length;o<u;o++){var i=n[o];r[i]=this.get({key:i,type:e})}return r}};e.default=x}]).default}));